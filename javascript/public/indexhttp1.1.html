<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SSE Example</title>
</head>
<body>
  <h1>Server-Sent Events Example</h1>

  <script>
    for (let i = 1; i <= 8; i++) {
      const eventsDiv = document.createElement('div');
      const header = document.createElement('h1');
      eventsDiv.id = `${i}`;
      header.innerHTML = `Event Stream ${i}`;
      eventsDiv.appendChild(header);

      eventsDiv.style.height = "500px";
      eventsDiv.style.overflow = "scroll";
      eventsDiv.style.border = "3px solid black";
      eventsDiv.style.padding = "5px";
      document.body.appendChild(eventsDiv);
  
      const eventSource = new EventSource(`/${i}`);
      eventSource.onmessage = function(event) {
        const message = document.createElement('p');
        message.textContent = `Received: ${event.data}`;
        eventsDiv.appendChild(message);
      };
  
      eventSource.onend = function() {
        console.log('Event stream ended');
        eventSource.close(); // Close the EventSource
      };
  
      eventSource.onerror = function(e) {
        console.log('Error: ', e);
        eventSource.close();
      };
    }
  </script>
</body>
</html>
